#!/bin/sh

# Clean up files not tracked by opkg

rm -f /opt/etc/init.d/S50trusttunnel

# Remove config directory if empty (conffiles may have been kept)
rmdir /opt/etc/trusttunnel 2>/dev/null || true

# Remove NDM interface registration
ndmc -c 'interface OpkgTun0 down' >/dev/null 2>&1 || true
ndmc -c 'no interface OpkgTun0' >/dev/null 2>&1 || true

# Remove Linux links created by client (new and legacy names)
ip link del opkgtun0 2>/dev/null || true
ip link del OpkgTun0 2>/dev/null || true
ip link del tun0 2>/dev/null || true

exit 0
